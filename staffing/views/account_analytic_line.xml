<odoo>                      
  <data>
        <record id="timesheet_view_tree_inherit" model="ir.ui.view">
            <field name="name">Timesheet</field>
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="hr_timesheet.hr_timesheet_line_tree"/>
	    <field name="priority">5</field>
            <field name="arch" type="xml">
		<field name="date" position="after">
			<field name="date_end"/>
			<field name="employee_id"/>
			<field name="category"/>
			<field name="rel_project_staffing_aggregation"/>
			<field name="amount" sum="Total"/>
		</field>
                <field name="unit_amount" position="replace">
			<!-- suppression du widget timesheet_uom qui empÃªche de saisir tous les montants-->
			<field name="unit_amount" optional="show" sum="Total" />
                </field>
            </field>
        </record>

    <record id="action_recompute_timesheet_amount" model="ir.actions.server">
          <field name="name">Recalculer le montant des feuilles de temps</field>
          <field name="model_id" ref="model_account_analytic_line"/>
          <field name="binding_model_id" ref="model_account_analytic_line"/>
          <field name="state">code</field>
	  <field name="code">
for rec in records:
    rec.with_context(do_not_update_staffing_report=True, do_not_update_project=True).refresh_amount()
env['hr.employee_staffing_report'].sudo().recompute_if_has_to_be_recomputed()
env['project.project'].sudo().recompute_if_has_to_be_recomputed()
  	  </field>
          <field name="groups_id" eval="[(4, ref('account.group_account_manager'))]" />
   </record>


        <record id="hr_timesheet_line_tree_period_depending" model="ir.ui.view">
            <field name="name">account.analytic.line.tree.hr_timesheet</field>
            <field name="model">account.analytic.line</field>
            <field name="arch" type="xml">
		 <tree>
		    <field name="date" />
                    <field name="date_end"/>
                    <field name="employee_id"/>
                    <field name="category"/>
                    <field name="rel_project_staffing_aggregation"/>
                    <field name="amount" sum="Total" optional="hide"/>
                    <field name="unit_amount" sum="Total" optional="hide"/>
                    <field name="period_unit_amount" sum="Total"/>
                    <field name="period_amount" sum="Total"/>
		    <field name="project_id" optional="hide"/>
                    <field name="name" optional="hide"/>
                </tree>
            </field>
        </record>
  </data>
</odoo>
