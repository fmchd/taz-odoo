<odoo>
    <data>
        <record id="view_project_search" model="ir.ui.view">
            <field name="name">Project</field>
            <field name="model">project.project</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <search string="Search Project">
                    <field name="name" string="N° ou nom du projet" filter_domain="['|', ('number', 'ilike', self), ('name', 'ilike', self)]"/>
                    <field name="project_director_employee_id" string="Directeur de mission (nom de famille)"/>
                    <field name="partner_id" string="Client" filter_domain="[('partner_id', 'child_of', self)]"/>
		    <field name="rel_partner_industry_id" string="Business domain" />
                    <field name="stage_id" groups="project.group_project_stages"/>
                    <field name="project_group_id" string="Groupe de projets"/>
                    <filter string="Mes projets" name="own_projects" domain="[('user_enrolled_ids', 'in', uid)]"/>
                    <filter string="Projets ni terminés ni annulés" name="open_projects" domain="[('stage_id.state', '!=', 'closed')]"/>
                    <filter string="Projet à revoir entre le DM et l'ADV" name="is_review_needed" domain="[('is_review_needed', '=', True), ('stage_id.state', '!=', 'closed')]"/>
                    <filter string="Projets ayant changé de statut depuis 7 jours" name="recent_project_changed" domain="[('state_last_change_date', '&gt;=', ((context_today() + relativedelta(days=-7)).strftime('%Y-%m-%d')))]"/>
                    <separator/>
                    <filter string="Date de début" name="start_date" date="date_start"/>
                    <filter string="Date de fin" name="end_date" date="date"/>
                    <separator/>
                    <filter string="Archived" name="inactive" domain="[('active', '=', False)]"/>
                    <group expand="0" string="Group By">
                        <filter string="Directeur de mission" name="Manager" context="{'group_by': 'project_director_employee_id'}"/>
                        <filter string="Client" name="Partner" context="{'group_by': 'partner_id'}"/>
                        <filter string="Business domain" name="groupby_rel_partner_industry_id" context="{'group_by': 'rel_partner_industry_id'}"/>
                        <filter string="Statut" name="groupby_stage" context="{'group_by': 'stage_id'}" groups="project.group_project_stages"/>
                    </group>
                </search>
            </field>
        </record>

	   <record model="ir.ui.view" id="project_accounting.project_tree">
	      <field name="name">Project</field>
	      <field name="model">project.project</field>
	      <field name="priority">5</field>
	      <field name="arch" type="xml">
		  <tree 
			  decoration-success="color_rel == 'decoration-success'" decoration-info="color_rel == 'decoration-info'" decoration-warning="color_rel == 'decoration-warning'"
			  decoration-danger="color_rel == 'decoration-danger'" decoration-muted="color_rel == 'decoration-muted'" decoration-primary="color_rel == 'decoration-primary'"
			      >
		  <field name="id" widget="open_tab"/>
		  <field name="number"/>
		  <field name="name" />
		  <field name="partner_id" context="{'default_is_company': True, 'tree_view_ref':'taz-common.company_tree', 'form_view_ref':'taz-common.company_form'}" domain="[('is_company', '=', True)]" />
		  <field name="project_director_employee_id" optional="show" />
		  <field name="outsourcing" optional="show"/>
		  <field name="stage_id" 
			  widget="badge" optional="show"
			  decoration-success="color_rel == 'decoration-success'" decoration-info="color_rel == 'decoration-info'" decoration-warning="color_rel == 'decoration-warning'"
			  decoration-danger="color_rel == 'decoration-danger'" decoration-muted="color_rel == 'decoration-muted'" decoration-primary="color_rel == 'decoration-primary'"
			  />
		  <field name="color_rel" invisible="1" />
		  <field name="order_sum_sale_order_lines" optional="show" />
		  <field name="remark" optional="hide" />
		  <field name="invoicing_comment" optional="show" groups="account.group_account_manager"/>
            	  <field name="order_to_invoice_company" optional="hide" />
            	  <field name="company_invoice_sum_move_lines" optional="hide" />
		  <field name="company_to_invoice_left" optional="hide" />
		  <field name="agreement_id" optional="show"/>
		</tree>
	      </field>
	    </record>

	<record id="seq_project" model="ir.sequence">
		<field name="name">Preject number sequence</field>
		<field name="code">project.project</field>
		<field name="active">True</field>
		<field name="prefix">%(y)s</field>
		<field name="number_increment">1</field>
			<!--	DO NOT UPDATE THE SEQUENCE NUMBER NEXT AFTER CREATION #TODO : move to sequence dedicated XML and set "no update" flag
				<field name="number_next">1</field>
			-->
		<field name="padding">3</field>
		<field name="implementation">standard</field>
	</record>


	   <record model="ir.ui.view" id="project_accounting.project_form">
	      <field name="name">Project</field>
	      <field name="model">project.project</field>
	      <field name="priority">5</field>
	      <field name="arch" type="xml">
		<form string="Project" class="o_form_project_project" js_class="project_form">
			<header>
				<!--
				<field name="stage_id" widget="statusbar" readonly="1"/>
					<field name="stage_id" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}" groups="project.group_project_stages"/>
					-->
			</header>
			<field name="company_id" invisible="1"/>
			<field name="analytic_account_id" invisible="1"/>
			<sheet string="Project">

				<widget name="web_ribbon" title="Archived" bg_color="bg-danger" attrs="{'invisible': [('active', '=', True)]}"/>

                                <div class="oe_button_box" name="button_box">
                                    <button class="oe_stat_button" type="object" name="action_open_all_account_move_lines" icon="fa-eye">
                                        <div class="o_form_field o_stat_info">
                                           <span class="o_stat_text">Toutes les écritures</span>
                                        </div>
                                    </button>
			    	</div>

				<field name="active" invisible="1"/>

				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_validated_order', '=', True)]}">
					Au moins un bon de commande client n'est pas à l'état 'Bon de commande'.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_validated_purchase_order', '=', True)]}">
					Au moins un bon de commande fournisseur n'est pas à l'état 'Bon de commande'.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_consistant_outsourcing', '=', True)]}">
					Le champ "Type de sous-traitance" n'est pas renseigné, ou bien il manque des achats sur ce projet.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_sale_order_with_draft', '=', True)]}">
					Le projet est en statut Accord client/Commandé/Terminé (on devrait avoir du book) mais le total des BC client (quelque soit leur statut) est nul.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_consistant_prevent_napta_creation', '=', True)]}">
					La case "Ne pas créer sur Napta" est cochée alors que le montant HT du dispositif Tasmane (ou la production Tasmane) à date n'est pas nul et que la date de fin de la mission est postérieure au 1er janvier 2023.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_outsource_part_amount_current', '=', True)]}">
					Le Montant HT du dispositif sous-traité à date n'est pas correct. En effet, la somme des 'Montants HT de revente' des lignes d'au moins un Bon de commande Fournisseur n'est pas strictement positive.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_affected_book', '=', True)]}">
					Il n'existe aucune ligne de répartition du book par employé (et le book n'est pas validé). Si le book de cette mission n'est pas attribuable à des salariés, merci de valider le book. Sinon, merci de renseigner la répartition du book entre les Tasmaniens.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_validated_book', '=', True)]}">
					La répartition du book n'est pas validée.
				</div>
				<div class="alert alert-warning mb-0" role="alert" attrs="{'invisible': [('is_affected_book', '=', True)]}">
				</div>
				<field name="is_validated_order" invisible="1"/>
				<field name="is_validated_book" invisible="1"/>
				<field name="is_consistant_outsourcing" invisible="1"/>
				<field name="is_validated_purchase_order" invisible="1"/>
				<field name="is_review_needed" invisible="1"/>
				<field name="is_sale_order_with_draft" invisible="1"/>
				<field name="is_consistant_prevent_napta_creation" invisible="1"/>
				<field name="is_outsource_part_amount_current" invisible="1"/>
				<field name="is_affected_book" invisible="1"/>

					
				<div class="oe_title">
					<h1 class="d-flex flex-row">
				    		<field name="number" nolabel="1" style="width:12%%"/>
				    		<field name="name" class="o_text_overflow" placeholder="Intitulé du projet" required="1"/>
					</h1>
                    		</div>
				    <group>
					<group>
					    <field name="partner_id" required="1" options="{'no_quick_create': True}" context="{'default_is_company': True, 'tree_view_ref':'taz-common.company_tree', 'form_view_ref':'taz-common.company_form'}" domain="[('is_company', '=', True), ('type', '=', 'contact')]" />
					    <field name="stage_id" required="1"/>
					    <field name="state_last_change_date" invisible="1" readonly="1"/>
					    <field name="outsourcing"/>
					    <field name="agreement_id"/>
					    <field name="state" invisible="1"/>
					    <field name="probability"/>
					</group>
					<group>
					    <field name="project_director_employee_id" attrs="{'readonly':[('active','=',False)]}" />
					    <field name="project_manager" attrs="{'readonly':[('active','=',False)]}" />
					    <label for="date_start" string="Dates de début/fin"/>
					    <div name="dates" class="o_row">
						<field name="date_start" widget="daterange" options="{&quot;related_end_date&quot;: &quot;date&quot;}"/>
						<i class="fa fa-long-arrow-right mx-2 oe_edit_only" aria-label="Arrow icon" title="Arrow"/>
						<i class="fa fa-long-arrow-right mx-2 oe_read_only" aria-label="Arrow icon" title="Arrow" attrs="{'invisible': [('date_start', '=', False), ('date', '=', False)]}"/>
						<field name="date" widget="daterange" options="{&quot;related_start_date&quot;: &quot;date_start&quot;}"/>
					    </div>
					    <field name="project_group_id"/>
					    <field name="remark"/>
					    <field name="invoicing_comment" groups="account.group_account_manager"/>
					</group>
				   </group>
				<notebook>
					<page name="dashboard" string="Synthèse À DATE">
						<group col="3">
							<group string="Commandes du client à Tasmane">
                                                                <field name="order_sum_sale_order_lines_with_draft"/>
								<field name="order_sum_sale_order_lines" />
								<button type="object" name="action_open_sale_order_lines" string="Voir les lignes de commande"/>
								<button type="object" name="create_sale_order" string="Créer commande client" /> 
								<button type="object" name="compute" string="Forcer recalcul" groups="base.group_system"/> 
                                                        </group>
                                                	<group string="Production co-traitée" attrs="{'invisible': [('cosource_part_amount_current', '=', 0), ('cosource_part_cost_current', '=', 0)]}">
                                                                <field name="cosource_part_amount_current" />
                                                                <field name="cosource_part_cost_current"/>
                                                                <field name="cosource_part_marging_amount_current"/>
                                                                <field name="cosource_part_marging_rate_current" widget="progressbar"/>
                                                        </group>
							<group string="Marge actuelle hors co-traitance">
                                                                <field name="order_amount_current"/>
                                                                <field name="order_cost_current"/>
                                                                <field name="order_marging_amount_current"/>
                                                                <field name="order_marging_rate_current" widget="progressbar"/>
							</group>
						</group>
						<group col="3">
							<group string="Production par le dispositif Tasmane">
					    			<field name="company_part_amount_current" force_save="1"/>
					    			<field name="company_part_cost_current" force_save="1"/>
					    			<field name="company_part_marging_amount_current"/>
					    			<field name="company_part_marging_rate_current" widget="progressbar"/>
							</group>
                                                	<group string="Production sous-traitée par Tasmane">
                                                                <field name="outsource_part_amount_current" />
                                                                <field name="outsource_part_cost_current"/>
                                                                <field name="outsource_part_marging_amount_current"/>
                                                                <field name="outsource_part_marging_rate_current" widget="progressbar"/>
                                                        </group>
                                                	<group string="Autres prestations (exemple : séminaire chez Tasmane)">
                                                                <field name="other_part_amount_current" force_save="1"/>
                                                                <field name="other_part_cost_current"/>
                                                                <field name="other_part_marging_amount_current"/>
                                                                <field name="other_part_marging_rate_current" widget="progressbar"/>
                                                        </group>
						</group>
					</page>
					<page name="project_structure" string="Structure INITIALE du projet">
						<group col="3">
							<group string="Production co-traitée">
								<field name="cosource_part_amount_initial"/>
								<field name="cosource_part_cost_initial"/>
								<field name="cosource_part_marging_amount_initial"/>
								<field name="cosource_part_marging_rate_initial" widget="progressbar"/>
							</group>  
							<group string="Marge hors co-traitance">
								<field name="order_amount_initial"/>
								<field name="order_cost_initial"/>
								<field name="order_marging_amount_initial"/>
								<field name="order_marging_rate_initial" widget="progressbar"/>
							</group>
						</group>
						<group col="3">
							<group string="Dispositif Tasmane">
								<field name="company_part_amount_initial"/>
								<field name="company_part_cost_initial"/>
								<field name="company_part_marging_amount_initial"/>
								<field name="company_part_marging_rate_initial" widget="progressbar"/>
							</group>
							<group string="Production sous-traitée par Tasmane">
								<field name="outsource_part_amount_initial"/>
								<field name="outsource_part_cost_initial"/>
								<field name="outsource_part_marging_amount_initial"/>
								<field name="outsource_part_marging_rate_initial" widget="progressbar"/>
							</group>  
							<group string="Autres prestations (exemple : séminaire chez Tasmane)">
								<field name="other_part_amount_initial"/>
								<field name="other_part_cost_initial"/>
								<field name="other_part_marging_amount_initial"/>
								<field name="other_part_marging_rate_initial" widget="progressbar"/>
							</group>  
						</group>

					</page>
					<page name="customer_invoicing" string="Facturation client">
						<group>
							<group>
								<field name="partner_secondary_ids" widget="many2many_tags"/>
								<button type="object" colspan="2" name="action_open_out_account_move_lines" string="Voir les lignes de facture/avoir"/>
							</group>
							<group>
							</group>
						</group>
						<group col="3">
							<group string="Facturation HT de Tasmane au client">
            							<field name="order_to_invoice_company" />
            							<field name="company_invoice_sum_move_lines" />
								<field name="company_to_invoice_left" />
							</group>
							<group string="Facturation TTC de Tasmane au client">
            							<field name="order_to_invoice_company_with_tax" />
								<field name="company_invoice_sum_move_lines_with_tax" />
								<field name="company_to_invoice_left_with_tax" />
							</group>
							<group string="Paiement TTC du client à Tasmane">
								<field name="company_paid" />
								<field name="company_residual" />
							</group>
						</group>
					</page>
					<page name="purchase" string="Achats">
							<field name="project_outsourcing_link_ids" context="{'default_project_id' : active_id}">
								<tree>    
									<field name="project_id" optional="hide"/>
									<field name="partner_id" context="{'default_is_company': True, 'tree_view_ref':'taz-common.company_tree', 'form_view_ref':'taz-common.company_form'}" domain="[('is_company', '=', True)]" />
									<field name="link_type"/>
									<field name="outsource_part_amount_current" string="Prix revente HT" sum="Total"/>
									<field name="order_sum_purchase_order_lines" string="Commandé par Tasmane HT" sum="Total"/>
									<field name="order_direct_payment_amount" string="Part en paiement direct HT" sum="Total"/>
									<field name="order_company_payment_amount" string="Part en paiement Tasmane HT" sum="Total"/>
									<field name="sum_account_move_lines" sum="Total"/>
								</tree>                                
							</field>

						<group>
            						<field name="order_to_invoice_outsourcing" />
						</group>
					</page>
					<page name="book" string="Book">
						<group string="Book brut du projet">
							<group>
								<field name="default_book_end" />
								<field name="is_book_manually_computed" groups="account.group_account_manager" />
								<field name="is_book_manually_computed" invisible="1"/>
							</group>
							<group>
								<field name="book_period_ids" colspan="2" nolabel="1" context="{'default_project_id':active_id}" attrs="{'readonly': [('is_book_manually_computed', '=', False)]}">
									<tree editable="top">
										<field name="project_id" invisible="1"/>
										<field name="reference_period"/>
										<field name="period_project_book" sum="Total"/>
									</tree>
								</field>
							</group>
						</group>
						<group string="Valorisation du book par DM/manager">
							<group>
								<field name="book_validation_employee_id" />
								<field name="book_validation_datetime" readonly="1" force_save="1"/>
								<field name="project_book_factor"/>
								<field name="book_comment" attrs="{'invisible': [('is_book_manually_computed', '=', False)]}"/>
							</group>
							<group>
								<field name="book_employee_distribution_ids" colspan="2" nolabel="1" context="{'default_project_id':active_id}" attrs="{'invisible': [('is_book_manually_computed', '=', True)]}">
									<tree editable="top">
										<field name="project_id" invisible="1"/>
										<field name="employee_id"/>
										<field name="book_factor" sum="Total"/>
										<field name="final_book_factor" sum="Total"/>
									</tree>   
								</field>
							</group>
						</group>
						<field name="book_employee_distribution_period_ids"  context="{'default_project_id':active_id}"  attrs="{'readonly': [('is_book_manually_computed', '=', False)]}">
							<tree editable="top">
								<field name="project_id" optional="hide" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="rel_is_book_manually_computed" optional="hide" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="rel_book_comment" optional="hide" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="employee_id" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
									<!--
								<field name="reference_period" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
									-->
								<field name="project_book_period_id" domain="[('project_id', '=', context.get('default_project_id'))]" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="period_project_book" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="final_book_factor" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
								<field name="period_project_book_employee" sum="Total" attrs="{'readonly': [('rel_is_book_manually_computed', '=', False)]}"/>
							</tree>    
						</field>
					</page>
					<page name="account_closing" string="Clôtures comptables">
						<field name="accounting_closing_ids" context="{'default_project_id':active_id}"/>
						<group>
							<group>
								<field name="has_provision_running"/>
							</group>
						</group>
					</page>
					<page string="Autres info et contrôles (debug admin)"  groups="base.group_system">
						<group>
							<group>
					    		    <field name="description" options="{'resizable': true}" placeholder="Description du projet..."/>
							    <field name="is_purchase_order_received"/>
							    <field name="purchase_order_number"/>
							    <field name="amount"/>
							    <field name="billed_amount"/>
							    <field name="payed_amount"/>
							</group>
							<group>
					    			<field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
					    			<field name="analytic_account_id" readonly="1"/>
							</group>
							<group string="Contrôles automatisés">
								<field name="is_validated_order"/>
								<field name="is_validated_book"/>
								<field name="is_consistant_outsourcing"/>
								<field name="is_validated_purchase_order"/>
								<field name="is_sale_order_with_draft"/>
								<field name="is_consistant_prevent_napta_creation"/>
								<field name="is_outsource_part_amount_current"/>
								<field name="is_affected_book"/>
								<field name="is_review_needed"/>
							</group>

						</group>
					</page>
				</notebook>
			</sheet>
		<div class="oe_chatter">
                    <field name="message_follower_ids" options="{'post_refresh':True}" help="Follow this project to automatically track the events associated to tasks and issues of this project." groups="base.group_user"/>
		    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
		</form>
	      </field>
	    </record>

	    <record id="project_action" model="ir.actions.act_window">
		<field name="name">Projets</field>
		<field name="res_model">project.project</field>
		<field name="view_mode">tree,form</field>
		<field name="view_ids" eval="
				    [
				    (5, 0, 0),
				    (0, 0, {'view_mode': 'tree', 'view_id': ref('project_accounting.project_tree')}),
				    (0, 0, {'view_mode': 'form', 'view_id': ref('project_accounting.project_form')}),
				      ]" />
	    </record>

	    <menuitem name="Projets ADV" id="project_menu" sequence="5" parent="project.menu_main_pm" action="project_action"/>


	   <record model="ir.ui.view" id="project_kanban">
	      <field name="name">Project</field>
	      <field name="model">project.project</field>
	      <field name="priority">5</field>
	      <field name="arch" type="xml">
		<kanban class="oe_background_grey o_kanban_dashboard o_project_kanban o_emphasize_colors" sample="1" default_order="sequence, number">
                    <field name="display_name"/>
                    <field name="partner_id"/>
                    <field name="commercial_partner_id"/>
                    <field name="color"/>
                    <field name="task_count"/>
                    <field name="milestone_count_reached"/>
                    <field name="milestone_count"/>
                    <field name="allow_milestones"/>
                    <field name="label_tasks"/>
                    <field name="alias_id"/>
                    <field name="alias_name"/>
                    <field name="alias_domain"/>
                    <field name="is_favorite"/>
                    <field name="rating_count"/>
                    <field name="rating_avg"/>
                    <field name="rating_status"/>
                    <field name="rating_active"/>
                    <field name="analytic_account_id"/>
                    <field name="date"/>
                    <field name="privacy_visibility"/>
                    <field name="last_update_color"/>
                    <field name="last_update_status"/>
                    <field name="tag_ids"/>
                    <field name="number"/>
                    <progressbar field="last_update_status" colors="{&quot;on_track&quot;: &quot;success&quot;, &quot;at_risk&quot;: &quot;warning&quot;, &quot;off_track&quot;: &quot;danger&quot;, &quot;on_hold&quot;: &quot;info&quot;}"/>
                    <field name="sequence" widget="handle"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="#{kanban_color(record.color.raw_value)} oe_kanban_global_click o_has_icon oe_kanban_content oe_kanban_card">
                                <div class="o_project_kanban_main ">
                                    <div class="o_kanban_card_content mw-100">
                                        <div class="o_kanban_primary_left">
                                            <div class="o_primary">
                                                <span class="o_text_overflow" t-att-title="record.display_name.value"><t t-esc="record.display_name.value"/></span>
                                                <span class="o_text_overflow text-muted" t-if="record.partner_id.value">
                                                    <span class="fa fa-user me-2" aria-label="Partner" title="Partner"/><t t-esc="record.partner_id.value"/>
                                                </span>
                                                <div t-if="record.date.raw_value or record.date_start.raw_value" class="text-muted o_row">
                                                    <span class="fa fa-clock-o me-2" title="Dates"/><field name="date_start"/>
                                                    <i t-if="record.date.raw_value and record.date_start.raw_value" class="fa fa-long-arrow-right mx-2 oe_read_only" aria-label="Arrow icon" title="Arrow"/>
                                                    <field name="date"/>
                                                </div>
                                                <div t-if="record.alias_name.value and record.alias_domain.value" class="text-muted text-truncate" t-att-title="record.alias_id.value">
                                                    <span class="fa fa-envelope-o me-2" aria-label="Domain Alias" title="Domain Alias"/><t t-esc="record.alias_id.value"/>
                                                </div>
                                                <div t-if="record.rating_active.raw_value and record.rating_count.raw_value &gt; 0" class="text-muted" groups="project.group_project_rating">
                                                    <b class="me-1">
                                                        <span style="font-weight:bold;" class="fa mt4 fa-smile-o text-success" t-if="record.rating_avg.raw_value &gt;= 3.66" title="Average Rating: Satisfied" role="img" aria-label="Happy face"/>
                                                        <span style="font-weight:bold;" class="fa mt4 fa-meh-o text-warning" t-elif="record.rating_avg.raw_value &gt;= 2.33" title="Average Rating: Okay" role="img" aria-label="Neutral face"/>
                                                        <span style="font-weight:bold;" class="fa mt4 fa-frown-o text-danger" t-else="" title="Average Rating: Dissatisfied" role="img" aria-label="Sad face"/>
                                                    </b>
                                                    <field name="rating_avg_percentage" widget="percentage"/>
                                                </div>
                                                <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <span>
                                       <field name="is_favorite" widget="boolean_favorite" nolabel="1" force_save="1"/>
                                    </span>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
	      </field>
	   </record>
		
    <record id="action_recompute_project" model="ir.actions.server">
          <field name="name">recompute_project</field>
          <field name="model_id" ref="model_project_project"/>
          <field name="binding_model_id" ref="model_project_project"/>
          <field name="state">code</field>
          <field name="code">for rec in records:
                  rec.compute()</field>
          <field name="groups_id" eval="[(4, ref('base.group_system'))]" />
  </record>

	    <!-- ACTION APPLICAQUE AUX UTILISATUER QUI ONT LE droit de gestion des étapes du projet (ie admin) -->
	    <record id="project.open_view_project_all_group_stage" model="ir.actions.act_window">
		<field name="context">{'search_default_groupby_stage' : 1, 'search_default_recent_project_changed' : 0, 'search_default_own_projects' : 1}</field>
      		<field name="search_view_id" ref="view_project_search"/>
		<field name="view_ids" eval="
				    [
				    (5, 0, 0),
				    (0, 0, {'view_mode': 'kanban', 'view_id': ref('project_accounting.project_kanban')}),
				    (0, 0, {'view_mode': 'tree', 'view_id': ref('project_accounting.project_tree')}),
				    (0, 0, {'view_mode': 'form', 'view_id': ref('project_accounting.project_form')}),
				      ]" />
	    </record>

	    <!-- ACTION APPLICAQUE AUX UTILISATUER SANS LE droit de gestion des étapes du projet -->
	    <record id="project.open_view_project_all" model="ir.actions.act_window">
		<field name="context">{'search_default_groupby_stage' : 1, 'search_default_recent_project_changed' : 0, 'search_default_own_projects' : 1}</field>
      		<field name="search_view_id" ref="view_project_search"/>
		<field name="view_ids" eval="
				    [
				    (5, 0, 0),
				    (0, 0, {'view_mode': 'kanban', 'view_id': ref('project_accounting.project_kanban')}),
				    (0, 0, {'view_mode': 'tree', 'view_id': ref('project_accounting.project_tree')}),
				    (0, 0, {'view_mode': 'form', 'view_id': ref('project_accounting.project_form')}),
				      ]" />
	    </record>

	<!--
        <record id="view_project_kanban_inherit" model="ir.ui.view">
            <field name="name">Project</field>
            <field name="model">project.project</field>
            <field name="inherit_id" ref="project.view_project_kanban"/>
	    <field name="arch" type="xml">
		<xpath expr="//kanban" position="attributes">
			<attribute name="on_create"></attribute>
			<attribute name="action"></attribute>
			<attribute name="type"></attribute>
                </xpath>
	    </field>
	</record>
	-->

    <record  id="project.menu_main_pm" model="ir.ui.menu">
	    <field name="sequence">4</field>
    </record>
   </data>
</odoo>

